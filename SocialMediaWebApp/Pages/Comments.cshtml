@page
@model SocialMediaWebApp.Pages.CommentsModel
@{
}



<div class="PostCard">
    <form method="post" asp-page-handler="Upvote" >
        <button type="submit" class="Postbutton" disabled="@(Model.PostDto.IsUpvoted)">
            Upvote
        </button>
        <input type="hidden" name="PostId" value="@Model.Postid" />
    </form>
    <form method="post" asp-page-handler="Downvote">
        <button type="submit" class="Postbutton" disabled="@(Model.PostDto.IsDownvoted)">
            Downvote
        </button>
        <input type="hidden" name="PostId" value="@Model.Postid" />
    </form>
    <p class="PostCardScore">Score : @Model.PostDto.Score</p>
   
    <p>Community - <a asp-page="/BrowseCommunity" asp-route-CommunityName="@Model.PostDto.CommunityName">@Model.PostDto.CommunityName</a> </p>
    <p>Author - <a asp-page="/BrowseUser" asp-route-UserName="@Model.PostDto.Author">@Model.PostDto.Author</a> </p>

    <p class="PostDate"> Date - @Model.PostDto.DateCreated</p>
    <div class="PostCardTitle">
        <h2> @Model.PostDto.Title</h2>
    </div>
    @if (Model.PostDto.Body != "null" && Model.PostDto.ImageUrl == "null")
    {
        <div class="PostCardBody">
            <p> @Model.PostDto.Body</p>
        </div>
    }
    @if (Model.PostDto.Body == "null" && Model.PostDto.ImageUrl != "null")
    {
        <img src="@Model.PostDto.ImageUrl" alt="Image">


    }
   
    
</div>
<div class="CommentSection">
    <form method="post" asp-page-handler="AddComment">
        <div>
            <h4>Comment Section</h4>
            <br />

            <textarea asp-for="CommentData.Body" class="form-control" rows="3"></textarea>
        </div>
        <button type="submit" class="btn btn-primary">Add Comment</button>
        <input type="hidden" name="PostId" value="@Model.Postid" />

    </form>
    <br />
    @foreach (var comment in Model.CommentDtos)
    {
        <br />
        <div class="CommentCard">
        <form method="post" asp-page-handler="UpvoteComment">
                <button type="submit" class="Postbutton" onclick="maintainscrollposition()" disabled="@(comment.IsUpvoted)">
                Upvote
            </button>
            <input type="hidden" name="commentId" value="@comment.CommentId" />
            <input type="hidden" name="PostId" value="@Model.Postid" />
        </form>
        <form method="post" asp-page-handler="DownvoteComment">
                <button type="submit" class="Postbutton" onclick="maintainscrollposition()" disabled="@(comment.IsDownvoted)">
                Downvote
            </button>
            <input type="hidden" name="commentId" value="@comment.CommentId" />
            <input type="hidden" name="PostId" value="@Model.Postid" />
        </form>
        <p class="PostCardScore">Score : @comment.Score</p>
        <p>Author - <a asp-page="/BrowseUser" asp-route-UserName="@Model.PostDto.Author">@Model.PostDto.Author</a> </p>
        <p class="PostDate"> Date - @comment.DateCreated</p>
        <div class="PostCardBody">
            <p> @comment.Body</p>
        </div>
        </div>
        <br />
    }

</div>